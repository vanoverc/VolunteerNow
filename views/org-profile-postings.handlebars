<head>
    <!-- Bootstrap Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
    <link rel="stylesheet" type="text/css" media="all" href="/css/organization.css">
</head>
<div id="org-events-container" class="container-fluid">
    <div class="row">
        <div class="col-xs-10 col-xs-offset-1">
            <div id="org-events-heading">
                <h1>Events</h1>
                <h2>{{org_name}}</h2>
            </div>
        </div>
    </div>
    {{#each event}}
    <div class="row">    
        <div class="col-xs-10 col-xs-offset-1 org-event-item">
            <input type="hidden" name="eventId" value={{event_id}}>
            <div class="row">
                <div class="col-xs-6">
                    <h4>{{event_name}}</h4>
                </div>
                <div class="col-xs-6" align="right">
                    <h4>Volunteers: {{vol_count}}</h4>
                </div>
            </div>
            <div>
                {{date_start}}{{date_end}}
                <br />
                {{event_description}}
                <br />
                {{min_age}}
                <br />
                <div class="row">
                    <div class="col-xs-6">
                        {{address_num}} {{address_street}}
                        <br />
                        {{address_state}} {{address_zip}}
                    </div>
                    <div class="col-xs-6">
                        {{contact_email}}
                        <br />
                        {{contact_phone}}
                        <br />
                        {{contact_name}}
                        <br />
                        {{contact_url}}
                    </div>
                </div>
            </div>
            <button id="cancel-event-btn" class="btn btn-primary cancel-event-btn">Cancel</button>
            <input type="hidden" name="event_id" value="{{event_id}}" />
        </div> 
    </div>
    {{/each}}
</div>

<!-- jQuery -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<!-- Latest compiled and minified JavaScript -->
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
<script>
   // Add cancel event listener
        $(".cancel-event-btn").click(function () {
            var eventId = $(this).next().val();
            var myData = {};
            myData.event = eventId;
            
            $.ajax({
                url: '/org-event-cancel',
                type: 'POST',
                data: { event: eventId},
                success: function (result) {
                    window.location.reload(true);
                }
            });
        });
    // Add event listener to view event details
    $(function () {
        $('.org-event-item').click(function () {
            var eventId = $(this).children().first().val();
            window.location.assign('/org-event-details/' + eventId);
        });
    });
</script>
